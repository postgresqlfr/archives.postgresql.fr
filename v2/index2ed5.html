
<!DOCTYPE
 html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
 <html>
 <!-- $Date: 2005/08/30 07:54:43 $ / $Revision: 1.29 $ / Last Theme Editor :$Author: jx $-->
  
<!-- Mirrored from drupal.postgresql.fr/?q=node/1714 by HTTrack Website Copier/3.x [XR&CO'2006], Sun, 12 Oct 2008 16:05:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<base  />
<style type="text/css" media="all">@import "misc/drupal.css";</style>
   <title>Erreur au lancement de Slony-I (version 1.2.1-1) crash! - PostgreSQLFr</title>
 <style type="text/css" media="screen" title="Normal Text">
    @import url("layout/css/blue/fixed.css");
    @import url(_guillaume/dotclear/themes/postgresql/style.html);
 </style>
 <style type="text/css" media="screen" title="Normal Text2">
    @import url("layout/css/blue/pgfr.css");
    @import url(_guillaume/dotclear/themes/postgresql/style.html);
 </style>
   </head>
   <body>
    <table border="0" cellspacing="5" cellpadding="0" width="100%">
     <tr>
      <!--td colspan="2" width="100%"-->
      <td colspan="2">
      <!-- Head -->
       <table border="0" cellspacing="0" cellpadding="0" width="100%">
        <tr>
	 <td align="left">
           <div id="pgHeader">
	    <div id="pgHeaderLogoLeft">
	     <a href="index.html" title="PostgreSQL"><img src="layout/images/hdr_left.png" width="230" height="80" alt="PostgreSQL" /></a>
	    </div>
	    <div id="pgHeaderLogoRight">
	     <a href="index.html" title="La base de donnÈes la plus sophistiquÈe au monde."><img src="layout/images/hdr_right.png" width="210" height="80" alt="La base de donnÈes la plus sophistiquÈe au monde." /></a>
	    </div>
	   </div>
         </td>
	 <td align="right">
         </td>
	</tr>
      </table> <!-- Head -->
      <br />
      <table border="0" cellspacing="0" cellpadding="0" width="100%">
              <tr>
	      	 <td align="left">

		<div class="pgTopNav">
		   <div class="pgTopNavLeft"> 
		     <img src="layout/images/nav_lft.png" width="7" height="23" alt="" />
		   </div>
		   <div class="pgTopNavRight">
		    <img src="layout/images/nav_rgt.png" width="7" height="23" alt="" />
		  </div>
		  <!--<ul class="pgTopNavList">-->
		  <ul class="pgTopNavList">
		   <li><a href="index03d2.html?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="indexf6e5.html?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="index71c4.html?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>

		   <li> <a href="indexf6fe.html?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="index79b7.html?q=forum">forums</a> </li>
		   <li> <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="index4404.html?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>

		  </ul>

<!--
		   <li><a href="?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>
		   <li> <a href="?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="?q=forum">forums</a> </li>
		   <li> <a href="?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>
-->
		  </ul>
	        </div>
		</td>
		</tr>
		</table>
      </td>
     </tr>
     <tr>
    <td style="vertical-align: top; width: 20%;">
<div class="block block-user" id="block-user-0">
<div class="pgSideNav">    <h2>Ouverture de session</h2>    
		    <div>
			<form action="http://drupal.postgresql.fr/?q=user/login" method="post">
<div class="user-login-block">
<input type="hidden" name="edit[destination]" value="node/1714" />
<div class="form-item">
 <label for="edit-name">Nom d'utilisateur:</label><br />
 <input type="text" maxlength="64" class="form-text" name="edit[name]" id="edit-name" size="15" value="" />
</div>
<div class="form-item">
 <label for="edit-pass">Mot de passe:</label><br />
 <input type="password" class="form-password" maxlength="64" name="edit[pass]" id="edit-pass" size="15" value="" />
</div>
<input type="submit" class="form-submit" name="op" value="Identification"  />
</div>

</form>
<div class="item-list"><ul><li><a href="indexc12c.html?q=user/password" title="Demander un nouveau mot de passe par e-mail.">Demander un nouveau mot de passe</a></li></ul></div>
		    </div></div></div>
<div class="block block-user" id="block-user-1">
<div class="pgSideNav">    <h2>Navigation</h2>    
		    <div>
			<div class="menu">
<ul>
<li class="leaf"><a href="indexa499.html?q=tracker">messages r√©cents</a></li>

</ul>
</div>
		    </div></div></div>
<div class="block block-block" id="block-block-4">
<div class="pgSideNav">    <h2>Contactez-nous</h2>    
		    <div>
			<p><strong>Administration du site&nbsp;:</strong><br />
"equipe chez postgresqlfr point org"<br><br />
<strong>Contact presse&nbsp;:</strong><br />
"fr chez postgresql point org"<br><br />
<strong>Contact association&nbsp;:</strong><br />
"bureau chez postgresqlfr point org"<br><br />
<strong>Questions PostgreSQL&nbsp;:</strong><br />
&nbsp;IRC&nbsp;:<br />
&nbsp;&nbsp;serveur <strong>irc.freenode.net</strong><br />
&nbsp;&nbsp;canal <strong>#postgresqlfr</strong></p>

		    </div></div></div>
<div class="block block-block" id="block-block-1">
<div class="pgSideNav">    <h2>Liens</h2>    
		    <div>
			<p><small></p>
<ul>
<li>
<a href="http://www.postgresqlfr.org/?q=node/view/162">Adh√©rer</a>
</li>
<li>
<a href="http://www.postgresqlfr.org/?q=node/473">Faire un don</a>
</li>
<li>
<a href="http://www.postgresqlfr.org/?q=node/163">Consulter les statuts</a>
</li>
</ul>
<ul>
<li>
<a href="http://www.postgresql.org/" class="active">Site original<br />
</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/" class="active">Site de traduction</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.3/">Doc v.8.3.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.2/">Doc v.8.2.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.1/">Doc v.8.1.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.0/">Doc v.8.0.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/7.4/">Doc v.7.4.x fr</a>
</li>
<li>
<a href="http://www.postgis.fr/">PostGIS</a>
</li>
<li>
<a href="http://www.postgresql.org/docs/techdocs">Techdocs</a>
</li>
<li>
<a href="http://www.varlena.com/varlena/GeneralBits/Tidbits/">General TidBits</a>
</li>
<p><!--</p>
<li>
<a href="http://www.postgresqlfr.org/?q=node/view/58">Version Windows</a>
</li>
<p>--></p>
<li>
<a href="http://www.postgresqlfr.org/drupal/?q=node/view/63">T√©moignages de pros</a>
</li>
<li>
<a href="http://archives.postgresql.org/pgsql-fr-generale/">Liste de diffusion</a>
</li>
<li>
<a href="http://wwwmaster.postgresql.org/download/mirrors-ftp">T√©l√©charger</a>
</li>
</ul>
<p></small></p>

		    </div></div></div>
<div class="block block-block" id="block-block-2">
<div class="pgSideNav">    <h2>Recherche</h2>    
		    <div>
			<form action="http://drupal.postgresql.fr/?q=search" method="post">
<div id="search">
<input class="form-text" type="text" size="15" value="" name="keys" alt="Enter the terms you wish to search for." /><br />
<input class="form-submit" type="submit" value="Recherche" />
</div>
</form>

		    </div></div></div>
<div class="block block-forum" id="block-forum-0">
<div class="pgSideNav">    <h2>Sujets du forum</h2>    
		    <div>
			<div class="item-list"><h3>Sujets actifs</h3><ul><li><a href="index253f.html?q=node/1742">A LIRE : FERMETURE DES FORUMS DRUPAL</a></li><li><a href="indexfc2e.html?q=node/1739" title="2 commentaires">Probl√®me  avec pg_dump</a></li><li><a href="index97c1.html?q=node/1731" title="5 commentaires">Connexions simultann√©es</a></li><li><a href="index32d3.html?q=node/1737" title="1 commentaire">Optimisation de la m√©moire sous PostgreSQL</a></li><li><a href="index2483.html?q=node/1736" title="3 commentaires">[R√©solu] Upgrade Postgre -> types et op√©rateurs</a></li></ul></div><div class="item-list"><h3>Nouveaux sujets:</h3><ul><li><a href="index253f.html?q=node/1742">A LIRE : FERMETURE DES FORUMS DRUPAL</a></li><li><a href="indexfc2e.html?q=node/1739" title="2 commentaires">Probl√®me  avec pg_dump</a></li><li><a href="index32d3.html?q=node/1737" title="1 commentaire">Optimisation de la m√©moire sous PostgreSQL</a></li><li><a href="index2483.html?q=node/1736" title="3 commentaires">[R√©solu] Upgrade Postgre -> types et op√©rateurs</a></li><li><a href="index82c4.html?q=node/1734" title="2 commentaires">[RESOLU] Probleme de connection en odbc</a></li></ul></div><div class="more-link"><a href="index79b7.html?q=forum" title="Lire les derniers sujets.">en lire plus</a></div>
		    </div></div></div>
<div class="block block-archive" id="block-archive-0">
<div class="pgSideNav">    <h2>Acc√©der aux archives</h2>    
		    <div>
			
<!-- calendar -->
<div class="calendar"><table summary="Un calendrier pour acc√©der aux archives.">
 <caption><a href="index9dfb.html?q=archive/2008/09/12" title="Mois pr√©c√©dent">&laquo;</a> Octobre 2008 &nbsp;</caption>
 <tr class="header-week">
 <th abbr="Lundi">Lun</th>
 <th abbr="Mardi">Mar</th>
 <th abbr="Mercredi">Mer</th>
 <th abbr="Jeudi">Jeu</th>
 <th abbr="Vendredi">Ven</th>
 <th abbr="Samedi">Sam</th>
 <th abbr="Dimanche">Dim</th>
</tr>
 <tr class="row-week"><td class="day-blank" colspan="2">&nbsp;</td>
  <td class="day-link"><a href="indexd3e2.html?q=archive/2008/10/1">1</a></td>
  <td class="day-normal">2</td>
  <td class="day-normal">3</td>
  <td class="day-normal">4</td>
  <td class="day-normal">5</td>
 </tr>
 <tr class="row-week">
  <td class="day-normal">6</td>
  <td class="day-normal">7</td>
  <td class="day-normal">8</td>
  <td class="day-normal">9</td>
  <td class="day-normal">10</td>
  <td class="day-normal">11</td>
  <td class="day-today">12</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">13</td>
  <td class="day-future">14</td>
  <td class="day-future">15</td>
  <td class="day-future">16</td>
  <td class="day-future">17</td>
  <td class="day-future">18</td>
  <td class="day-future">19</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">20</td>
  <td class="day-future">21</td>
  <td class="day-future">22</td>
  <td class="day-future">23</td>
  <td class="day-future">24</td>
  <td class="day-future">25</td>
  <td class="day-future">26</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">27</td>
  <td class="day-future">28</td>
  <td class="day-future">29</td>
  <td class="day-future">30</td>
  <td class="day-future">31</td>
  <td class="day-blank" colspan="2">&nbsp;</td>
 </tr>
</table></div>


		    </div></div></div>
<div class="block block-node" id="block-node-0">
<div class="pgSideNav">    <h2>Syndication</h2>    
		    <div>
			<div class="xml-icon"><a href="index9637.html?q=rss.xml"><img src="misc/xml.png" width="36" height="14" alt="Flux XML" title="Flux XML" /></a></div>
		    </div></div></div>
<div class="block block-poll" id="block-poll-0">
<div class="pgSideNav">    <h2>Sondage</h2>    
		    <div>
			<div class="poll"><div class="title">Quelle est la version de PostgreSQL la plus r√©pandue sur vos serveurs ?</div><div class="text">8.3</div><div class="bar"><div style="width: 10%;" class="foreground"></div></div><div class="percent">10%</div><div class="text">8.2</div><div class="bar"><div style="width: 42%;" class="foreground"></div></div><div class="percent">42%</div><div class="text">8.1</div><div class="bar"><div style="width: 40%;" class="foreground"></div></div><div class="percent">40%</div><div class="text">8.0</div><div class="bar"><div style="width: 2%;" class="foreground"></div></div><div class="percent">2%</div><div class="text">7.4</div><div class="bar"><div style="width: 6%;" class="foreground"></div></div><div class="percent">6%</div><div class="text">7.3 ou ant√©rieure</div><div class="bar"><div style="width: 0%;" class="foreground"></div></div><div class="percent">0%</div><div class="total">Nombre de votes: 48</div></div><div class="links"><a href="index8c57.html?q=node/1426#comment" title="Sauter au premier commentaire de ce message.">3 commentaires</a> | <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">anciens sondages</a></div>
		    </div></div></div>
    </td>

      <td style="vertical-align: top; width: 80%"><div class="breadcrumb"><a href="index03d2.html?q=">Accueil</a> &raquo; <a href="index79b7.html?q=forum">forums</a> &raquo; <a href="indexc742.html?q=forum/21">Technique - installation</a></div><h2 class="title">Erreur au lancement de Slony-I (version 1.2.1-1) crash!</h2>
<!-- begin content -->

<!-- node: "Erreur au lancement de Slony-I (version 1.2.1-1) crash!" -->
<!--<div class="pgFrontCenterUser">
<div class="pgFrontUser">
<div class="pgFrontUserInner">
--><div class="pgFrontUserWrap">
 <div class="pgFrontUserContent">	<h1 class="plop"><a href="indexa016.html?q=taxonomy/term/21">Technique - installation</a> | <a href="index2ed5.html?q=node/1714" class="active">Erreur au lancement de Slony-I (version 1.2.1-1) crash!</a></h1>
		    <p>
			    Par <a href="indexe2f6.html?q=user/3575" title="Voir le profil utilisateur.">mxltx</a> le 07/08/2008 - 18:07
		    </p>	
			    <p>Bonjour la communaut√©,</p>
<p>j'essaye de faire une replication simple (Master / Slave) avec slony-I (slon version 1.2.1-1).<br />
J'ai deux serveurs identique sgmtest01 et sgmtest02 (tous les deux sous Debian Etch).<br />
- J'ai install√© via 'apt-get' la liste ci-dessous sur chaqu'un : </p>
<p>root@sgmtest01:~# dpkg -l<br />
ii  postgresql-8.1                 8.1.11-0etch1                        object-relational SQL database, version 8.1<br />
ii  postgresql-8.1-slony1          1.2.1-1                              replication system for PostgreSQL<br />
ii  postgresql-client-8.1          8.1.11-0etch1                        front-end programs for PostgreSQL 8.1<br />
ii  postgresql-client-common       71                                   manager for multiple PostgreSQL client versi<br />
ii  postgresql-common              71                                   manager for PostgreSQL database clusters<br />
ii  slony1-bin                     1.2.1-1                              replication system for PostgreSQL<br />
ii  slony1-doc                     1.2.1-1                              Slony-I documentation </p>
<p>***Configuration postgres***</p>
<p>- j'ai bien configur√© mes fichiers 'pg_hba.conf', et 'postgresql.conf'<br />
- cr√©√© des utilisateurs de replication sur les deux serveurs<br />
- Cr√©ation d'une base ( + plpgsql language)<br />
- Dumper la base sur le slave</p>
<p>***Configuration slony***</p>
<p>Je me suis cr√©√© 3 fichiers : init_cluster.slnk :</p>
<p>##### INIT CLUSTER<br />
cluster name = replication;<br />
 node 1 admin conninfo='host=172.16.1.93 dbname=contactdb user=contactuser port=5432 password=contactuser';<br />
 node 2 admin conninfo='host=172.16.1.94 dbname=contactdb_slave user=contactuser port=5432 password=contactuser';<br />
  init cluster (id = 1, comment = 'Node 1 - contactdb@172.16.1.93');</p>
<p># STORE NODE<br />
  store node (id = 2, event node = 1, comment = 'Node 2 - contactdb_slave@172.16.1.94');<br />
  echo 'Set up replication nodes';</p>
<p># STORE PATH<br />
  echo 'Next: configure paths for each node/origin';<br />
  echo 'Replication nodes prepared';<br />
  echo 'Please start a slon replication daemon for each node';<br />
#####</p>
<p>un fichier : create_set.slnk :</p>
<p>#####cluster name = replication;<br />
 node 1 admin conninfo='host=172.16.1.93 dbname=contactdb user=contactuser port=5432 password=contactuser';<br />
 node 2 admin conninfo='host=172.16.1.94 dbname=contactdb_slave user=contactuser port=5432 password=contactuser';</p>
<p># TABLE ADD KEY</p>
<p># CREATE SET<br />
  try {<br />
    create set (id = 1, origin = 1, comment = 'Set 1 for replication');<br />
  } on error {<br />
    echo 'Could not create subscription set 1 for replication!';<br />
    exit -1;<br />
  }</p>
<p># SET ADD TABLE<br />
  echo 'Subscription set 1 created';<br />
  echo 'Adding tables to the subscription set';<br />
  set add table (set id = 1, origin = 1, id = 1,<br />
                 full qualified name = 'public.contact',<br />
                 comment = 'Table public.contact with primary key');<br />
  echo 'Add primary keyed table public.contact';</p>
<p># SET ADD SEQUENCE<br />
  echo 'Adding sequences to the subscription set';<br />
  set add sequence (set id = 1, origin = 1, id = 1,<br />
                    full qualified name = 'public.contact_seq',<br />
                    comment = 'Sequence public.contact_seq');<br />
  echo 'Add sequence public.contact_seq';<br />
  echo 'All tables added';<br />
####</p>
<p>un fichier : subscribe_set.slnk</p>
<p>####<br />
cluster name = replication;<br />
 node 1 admin conninfo='host=172.16.1.93 dbname=contactdb user=contactuser port=5432 password=contactuser';<br />
 node 2 admin conninfo='host=172.16.1.94 dbname=contactdb_slave user=contactuser port=5432 password=contactuser';<br />
  try {<br />
    subscribe set (id = 1, provider = 1, receiver = 2, forward = yes);<br />
  }<br />
  on error {<br />
    exit 1;<br />
  }<br />
  echo 'Subscribed nodes to set 1';<br />
####</p>
<p>Je n'ai pas d'erreur quand je passe ces trois fichier en argument a slonik.</p>
<p>1)<br />
root@sgmtest01:/etc/slony1/toolkit# slonik < init_cluster.slnk<br />
<stdin>:10: Set up replication nodes<br />
<stdin>:13: Next: configure paths for each node/origin<br />
<stdin>:14: Replication nodes prepared<br />
<stdin>:15: Please start a slon replication daemon for each node</p>
<p>2)<br />
root@sgmtest01:/etc/slony1/toolkit# slonik < create_set.slnk<br />
<stdin>:16: Subscription set 1 created<br />
<stdin>:17: Adding tables to the subscription set<br />
<stdin>:21: Add primary keyed table public.contact<br />
<stdin>:24: Adding sequences to the subscription set<br />
<stdin>:28: Add sequence public.contact_seq<br />
<stdin>:29: All tables added</p>
<p>3)<br />
root@sgmtest01:/etc/slony1/toolkit# slonik < subscribe_set.slnk<br />
<stdin>:10: Subscribed nodes to set 1</p>
<p>Mais je n'arrive pas a starter le process de replication :</p>
<p>lorsque je start le process sur le Master :</p>
<p>root@sgmtest01:/etc/slony1/toolkit# slon_start --config /usr/local/etc/slon_tools.conf 1<br />
Invoke slon for node 1 - /usr/bin/slon -p /var/run/slony1/node1.pid -s 1000 -d2 replication 'host=172.16.1.93 dbname=contactdb user=contactuser port=5432 password=contactuser' >>/var/log/slony1/node1-contactdb.log 2>&#038;1 </dev/null &#038;<br />
Slon successfully started for cluster replication, node node1<br />
PID [23807]<br />
Start the watchdog process as well...<br />
root@sgmtest01:/etc/slony1/toolkit# Invoke slon for node 1 - /usr/bin/slon -p /var/run/slony1/node1.pid -s 1000 -d2 replication 'host=172.16.1.93 dbname=contactdb user=contactuser port=5432 password=contactuser' >>/var/log/slony1/node1-contactdb.log 2>&#038;1 </dev/null &#038;</p>
<p>Mais voici les log qui demontrent que le service n'est pas up :</p>
<p>root@sgmtest01:/# tail -f /var/log/slony1/node1-contactdb.log<br />
HINT:  No function matches the given name and argument types. You may need to add explicit type casts.<br />
2008-08-07 17:24:12 CEST ERROR  please upgrade Slony-I shared module to version 1.2.1<br />
2008-08-07 17:24:12 CEST FATAL  main: Node has wrong Slony-I schema or module version loaded<br />
2008-08-07 17:24:12 CEST DEBUG2 slon_abort() from pid=24007<br />
2008-08-07 17:24:12 CEST DEBUG1 slon: shutdown requested<br />
2008-08-07 17:24:12 CEST DEBUG2 slon: notify worker process to shutdown<br />
2008-08-07 17:24:12 CEST DEBUG2 slon: child terminated status: 0; pid: 24007, current worker pid: 24007<br />
2008-08-07 17:24:12 CEST DEBUG1 slon: done<br />
2008-08-07 17:24:12 CEST DEBUG2 slon: remove pid file<br />
2008-08-07 17:24:12 CEST DEBUG2 slon: exit(0)</p>
<p>root@sgmtest01:~# tail -f /var/log/slony1/slon-contactdb-node1.err<br />
WATCHDOG: You ought to check the postmaster and slon for evidence of a crash!<br />
WATCHDOG: I'm going to restart slon for node1...<br />
WATCHDOG: Restarted slon for the replication cluster, PID<br />
WATCHDOG: No Slon is running for node node1!<br />
WATCHDOG: You ought to check the postmaster and slon for evidence of a crash!<br />
WATCHDOG: I'm going to restart slon for node1...<br />
WATCHDOG: Restarted slon for the replication cluster, PID 23932<br />
WATCHDOG: No Slon is running for node node1!<br />
WATCHDOG: You ought to check the postmaster and slon for evidence of a crash!<br />
WATCHDOG: I'm going to restart slon for node1...<br />
WATCHDOG: Restarted slon for the replication cluster, PID<br />
WATCHDOG: No Slon is running for node node1!<br />
WATCHDOG: You ought to check the postmaster and slon for evidence of a crash!<br />
WATCHDOG: I'm going to restart slon for node1...<br />
WATCHDOG: Restarted slon for the replication cluster, PID 23983<br />
WATCHDOG: No Slon is running for node node1!<br />
WATCHDOG: You ought to check the postmaster and slon for evidence of a crash!<br />
WATCHDOG: I'm going to restart slon for node1...</p>
<p>slon_kill<br />
slon_kill.pl...   Killing all slon and slon_watchdog instances for the cluster replication<br />
1.  Kill slon watchdogs<br />
slon_watchdog for cluster replication killed - PID [23818]</p>
<p>2. Kill slon processes<br />
No slon processes found</p>
<p>lorsque je start le process sur le Master avec :</p>
<p>root@sgmtest01:/etc/slony1/toolkit# slon replication "dbname=contactdb user=contactuser password=contactuser host=172.16.1.93"</p>
<p>2008-08-07 17:35:53 CEST CONFIG main: slon version 1.2.1 starting up<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: watchdog process started<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: watchdog ready - pid = 28470<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: worker process created - pid = 28471<br />
2008-08-07 17:35:53 CEST ERROR  cannot get Slony-I module version - ERROR:  function _replication.getmoduleversion() does not exist<br />
HINT:  No function matches the given name and argument types. You may need to add explicit type casts.<br />
2008-08-07 17:35:53 CEST ERROR  please upgrade Slony-I shared module to version 1.2.1<br />
2008-08-07 17:35:53 CEST FATAL  main: Node has wrong Slony-I schema or module version loaded<br />
2008-08-07 17:35:53 CEST DEBUG2 slon_abort() from pid=28471<br />
2008-08-07 17:35:53 CEST DEBUG1 slon: shutdown requested<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: notify worker process to shutdown<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: child terminated status: 0; pid: 28471, current worker pid: 28471<br />
2008-08-07 17:35:53 CEST DEBUG1 slon: done<br />
2008-08-07 17:35:53 CEST DEBUG2 slon: exit(0)</p>
<p>Sur le slave c'est la meme chose :</p>
<p>slon_start --config /usr/local/etc/slon_tools.conf 2<br />
me genere les memes erreurs.</p>
<p>Avez-vous deja eu ce probleme avec une config similaire ??<br />
Comment resoudre ce problme ??</p>
<p>Peut-on mettre a jour slony, sans toucher a postgres 8.1 (packag√© debain - Etch).</p>
<p>Mes fichiers 'slon_tools.conf' sont identiques sur les deux serveurs (Master &#038; Slave) est ce normal ??</p>
<p>Bref, il faut que cette solution libre de replication fonctionne.<br />
Ca ne peut pas se passer autrement...</p>
<p>Bien a vous,<br />
Mxltx</p>
<!--hr /--><div class="contentsLink">[ <a href="index027d.html?q=node/1725" title="Port 5432 non valable sous Leopard">sujet pr√©c√©dent</a> | <a href="index2c70.html?q=node/1555" title="PostgreSQL 8.3 sur Mac">sujet suivant</a> ]</div>
		     </div></div>
<!--</div>
</div>
</div>
</div> -->
<a id="comment"></a>
<form method="post" action="http://drupal.postgresql.fr/?q=comment"><div>
<div class="pgSideNav">    <h2>Options d'affichage des commentaires</h2>    
		    <div>
			<div class="form-item">
 <select name="mode"> <option value="1">A plat - repli√©</option>
 <option value="2">A plat - d√©pli√©</option>
 <option value="3">Par discussions - repli√©</option>
 <option value="4" selected="selected">Par discussions - d√©pli√©</option>
</select>
<select name="order"> <option value="1">Date - r√©cents en premier</option>
 <option value="2" selected="selected">Date - anciens en premier</option>
</select>
<select name="comments_per_page"> <option value="10">10 commentaires par page</option> <option value="30">30 commentaires par page</option> <option value="50" selected="selected">50 commentaires par page</option> <option value="70">70 commentaires par page</option> <option value="90">90 commentaires par page</option></select>
<input type="hidden" name="threshold" value="0" />
 <input type="submit" class="form-submit" name="op" value="Sauvegarder les param√®tres"  />

 <div class="description">S√©lectionnez la m√©thode d'affichage des commentaires que vous pr√©f√©rez, puis cliquez sur "Sauvegarder les param√®tres" pour activer vos changements.</div>
</div>

		    </div></div><input type="hidden" name="edit[nid]" value="1714" />
</div></form><form method="post" action="http://drupal.postgresql.fr/?q=comment"><div>
<input type="hidden" name="edit[nid]" value="1714" />
<a id="comment-5072"></a>
<div class="pgContentWrap"><h1 id="txtFrontFeatureHeading">Vieille version</h1>
		<p>
		    <b><a href="index6e6b.html?q=user/65" title="Voir le profil utilisateur.">SAS</a></b>/ = 8 Ao√ªt, 2008 - 11:37
		</p>
		<p>
		    <p>Bonjour, </p>
<p>La version packag√©e que vous utilisez est vraiment trop ancienne pour que vous puissiez l'utiliser sans risque.</p>
<p>Par exemple, avant la version 1.2.6 de slony, un switch/failover plante la r√©plication.</p>
<p>Vous devriez plut√¥t envisag√© de recompiler slony si vous ne pouvez trouver de paquet plus r√©cent.</p>
<p>Je suis √©tonn√© par ce message d'erreur :<br />
2008-08-07 17:24:12 CEST ERROR please upgrade Slony-I shared module to version 1.2.1<br />
2008-08-07 17:24:12 CEST FATAL main: Node has wrong Slony-I schema or module version loaded<br />
suivi de celui-ci :<br />
2008-08-07 17:35:53 CEST ERROR cannot get Slony-I module version - ERROR: function _replication.getmoduleversion() does not exist</p>
<p>il semblerait en fait que slony ne soit pas install√© correctement, voir que le store node ne soit pas pass√©.</p>
<p>Qui plus est, il manque les directives store path dans vos scripts. mais le probl√®me ne vient pas de l√†.</p>
<p>Je ne saurais trop vous conseiller de commencer par recompiler slony, l'installer, retenter et nous tenir au courant des erreurs √† ce moment-l√†.</p>
<p>Je peux vous garantir que Slony fonctionne.</p>
<p>Librement,<br />
St√©phane Schildknecht<br />
<a href="http://www.dalibo.com/">Dalibo</a><br />
<a href="http://www.postgresqlfr.org/">PostgreSQLFr</a></p>
<br /><!--hr /--><div class="contentsLink">[ Vous devez <a href="index7992.html?q=user/login">vous connecter</a> pour poster des commentaires ]</div>
		</p></div><div style="margin-left:25px;">
<a id="comment-5073"></a>
<div class="pgContentWrap"><h1 id="txtFrontFeatureHeading">Installation postgres-8.3 et slony 1.2.14-1</h1>
		<p>
		    <b><a href="indexe2f6.html?q=user/3575" title="Voir le profil utilisateur.">mxltx</a></b>/ = 8 Ao√ªt, 2008 - 15:15
		</p>
		<p>
		    <p>bonjour,</p>
<p>Merci pour votre reponse ...</p>
<p>En effet je viens de tout desinstaller, et j'ai r√©installer une version plus recente (un postgresql-8.3 et un slony 1.2.14-1).<br />
Desormais ca fonctionne impecable.</p>
<p>PS:<br />
J'ai √©galement les directives store path manquantes.</p>
<p>bref,<br />
Je vous remercie pour votre rapidit√© et votre qualit√© d'analyse... </p>
<p>Bien a vous,<br />
Mxltx</p>
<br /><!--hr /--><div class="contentsLink">[ Vous devez <a href="index7992.html?q=user/login">vous connecter</a> pour poster des commentaires ]</div>
		</p></div></div>
</div></form>
<!-- end content -->
              </td>

    </tr>
    <tr><td colspan="2">

		<div class="pgTopNav">
		   <div class="pgTopNavLeft"> 
		     <img src="layout/images/nav_lft.png" width="7" height="23" alt="" />
		   </div>
		   <div class="pgTopNavRight">
		    <img src="layout/images/nav_rgt.png" width="7" height="23" alt="" />
		  </div>
		  <!--<ul class="pgTopNavList">-->
		  <ul class="pgTopNavList">
		   <li><a href="index03d2.html?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="indexf6e5.html?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="index71c4.html?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>

		   <li> <a href="indexf6fe.html?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="index79b7.html?q=forum">forums</a> </li>
		   <li> <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="index4404.html?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>

		  </ul>

<!--
		   <li><a href="?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>
		   <li> <a href="?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="?q=forum">forums</a> </li>
		   <li> <a href="?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>
-->
		  </ul>
	        </div>
    </td></tr>
   </table>
   <p style="text-align: center;">&copy;&nbsp;PostgreSQLFr, tous droits r√©serv√©s.<br>
Site d√©clar√© √† la CNIL sous le num√©ro 1074678, conform√©ment √† la Loi en vigueur.
</p>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3921927-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<p></p>
   
</body>

<!-- Mirrored from drupal.postgresql.fr/?q=node/1714 by HTTrack Website Copier/3.x [XR&CO'2006], Sun, 12 Oct 2008 16:05:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>