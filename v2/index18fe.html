
<!DOCTYPE
 html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
 <html>
 <!-- $Date: 2005/08/30 07:54:43 $ / $Revision: 1.29 $ / Last Theme Editor :$Author: jx $-->
  
<!-- Mirrored from drupal.postgresql.fr/?q=node/297 by HTTrack Website Copier/3.x [XR&CO'2006], Sun, 12 Oct 2008 15:57:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<base  />
<style type="text/css" media="all">@import "misc/drupal.css";</style>
   <title>Points √† v√©rifier en ce qui concerne les performances de PostgreSQL 8.0 - PostgreSQLFr</title>
 <style type="text/css" media="screen" title="Normal Text">
    @import url("layout/css/blue/fixed.css");
    @import url(_guillaume/dotclear/themes/postgresql/style.html);
 </style>
 <style type="text/css" media="screen" title="Normal Text2">
    @import url("layout/css/blue/pgfr.css");
    @import url(_guillaume/dotclear/themes/postgresql/style.html);
 </style>
   </head>
   <body>
    <table border="0" cellspacing="5" cellpadding="0" width="100%">
     <tr>
      <!--td colspan="2" width="100%"-->
      <td colspan="2">
      <!-- Head -->
       <table border="0" cellspacing="0" cellpadding="0" width="100%">
        <tr>
	 <td align="left">
           <div id="pgHeader">
	    <div id="pgHeaderLogoLeft">
	     <a href="index.html" title="PostgreSQL"><img src="layout/images/hdr_left.png" width="230" height="80" alt="PostgreSQL" /></a>
	    </div>
	    <div id="pgHeaderLogoRight">
	     <a href="index.html" title="La base de donnÈes la plus sophistiquÈe au monde."><img src="layout/images/hdr_right.png" width="210" height="80" alt="La base de donnÈes la plus sophistiquÈe au monde." /></a>
	    </div>
	   </div>
         </td>
	 <td align="right">
         </td>
	</tr>
      </table> <!-- Head -->
      <br />
      <table border="0" cellspacing="0" cellpadding="0" width="100%">
              <tr>
	      	 <td align="left">

		<div class="pgTopNav">
		   <div class="pgTopNavLeft"> 
		     <img src="layout/images/nav_lft.png" width="7" height="23" alt="" />
		   </div>
		   <div class="pgTopNavRight">
		    <img src="layout/images/nav_rgt.png" width="7" height="23" alt="" />
		  </div>
		  <!--<ul class="pgTopNavList">-->
		  <ul class="pgTopNavList">
		   <li><a href="index03d2.html?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="indexf6e5.html?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="index71c4.html?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>

		   <li> <a href="indexf6fe.html?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="index79b7.html?q=forum">forums</a> </li>
		   <li> <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="index4404.html?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>

		  </ul>

<!--
		   <li><a href="?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>
		   <li> <a href="?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="?q=forum">forums</a> </li>
		   <li> <a href="?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>
-->
		  </ul>
	        </div>
		</td>
		</tr>
		</table>
      </td>
     </tr>
     <tr>
    <td style="vertical-align: top; width: 20%;">
<div class="block block-user" id="block-user-0">
<div class="pgSideNav">    <h2>Ouverture de session</h2>    
		    <div>
			<form action="http://drupal.postgresql.fr/?q=user/login" method="post">
<div class="user-login-block">
<input type="hidden" name="edit[destination]" value="node/297" />
<div class="form-item">
 <label for="edit-name">Nom d'utilisateur:</label><br />
 <input type="text" maxlength="64" class="form-text" name="edit[name]" id="edit-name" size="15" value="" />
</div>
<div class="form-item">
 <label for="edit-pass">Mot de passe:</label><br />
 <input type="password" class="form-password" maxlength="64" name="edit[pass]" id="edit-pass" size="15" value="" />
</div>
<input type="submit" class="form-submit" name="op" value="Identification"  />
</div>

</form>
<div class="item-list"><ul><li><a href="indexc12c.html?q=user/password" title="Demander un nouveau mot de passe par e-mail.">Demander un nouveau mot de passe</a></li></ul></div>
		    </div></div></div>
<div class="block block-user" id="block-user-1">
<div class="pgSideNav">    <h2>Navigation</h2>    
		    <div>
			<div class="menu">
<ul>
<li class="leaf"><a href="indexa499.html?q=tracker">messages r√©cents</a></li>

</ul>
</div>
		    </div></div></div>
<div class="block block-block" id="block-block-4">
<div class="pgSideNav">    <h2>Contactez-nous</h2>    
		    <div>
			<p><strong>Administration du site&nbsp;:</strong><br />
"equipe chez postgresqlfr point org"<br><br />
<strong>Contact presse&nbsp;:</strong><br />
"fr chez postgresql point org"<br><br />
<strong>Contact association&nbsp;:</strong><br />
"bureau chez postgresqlfr point org"<br><br />
<strong>Questions PostgreSQL&nbsp;:</strong><br />
&nbsp;IRC&nbsp;:<br />
&nbsp;&nbsp;serveur <strong>irc.freenode.net</strong><br />
&nbsp;&nbsp;canal <strong>#postgresqlfr</strong></p>

		    </div></div></div>
<div class="block block-block" id="block-block-1">
<div class="pgSideNav">    <h2>Liens</h2>    
		    <div>
			<p><small></p>
<ul>
<li>
<a href="http://www.postgresqlfr.org/?q=node/view/162">Adh√©rer</a>
</li>
<li>
<a href="http://www.postgresqlfr.org/?q=node/473">Faire un don</a>
</li>
<li>
<a href="http://www.postgresqlfr.org/?q=node/163">Consulter les statuts</a>
</li>
</ul>
<ul>
<li>
<a href="http://www.postgresql.org/" class="active">Site original<br />
</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/" class="active">Site de traduction</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.3/">Doc v.8.3.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.2/">Doc v.8.2.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.1/">Doc v.8.1.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/8.0/">Doc v.8.0.x fr</a>
</li>
<li>
<a href="http://docs.postgresqlfr.org/7.4/">Doc v.7.4.x fr</a>
</li>
<li>
<a href="http://www.postgis.fr/">PostGIS</a>
</li>
<li>
<a href="http://www.postgresql.org/docs/techdocs">Techdocs</a>
</li>
<li>
<a href="http://www.varlena.com/varlena/GeneralBits/Tidbits/">General TidBits</a>
</li>
<p><!--</p>
<li>
<a href="http://www.postgresqlfr.org/?q=node/view/58">Version Windows</a>
</li>
<p>--></p>
<li>
<a href="http://www.postgresqlfr.org/drupal/?q=node/view/63">T√©moignages de pros</a>
</li>
<li>
<a href="http://archives.postgresql.org/pgsql-fr-generale/">Liste de diffusion</a>
</li>
<li>
<a href="http://wwwmaster.postgresql.org/download/mirrors-ftp">T√©l√©charger</a>
</li>
</ul>
<p></small></p>

		    </div></div></div>
<div class="block block-block" id="block-block-2">
<div class="pgSideNav">    <h2>Recherche</h2>    
		    <div>
			<form action="http://drupal.postgresql.fr/?q=search" method="post">
<div id="search">
<input class="form-text" type="text" size="15" value="" name="keys" alt="Enter the terms you wish to search for." /><br />
<input class="form-submit" type="submit" value="Recherche" />
</div>
</form>

		    </div></div></div>
<div class="block block-forum" id="block-forum-0">
<div class="pgSideNav">    <h2>Sujets du forum</h2>    
		    <div>
			<div class="item-list"><h3>Sujets actifs</h3><ul><li><a href="index253f.html?q=node/1742">A LIRE : FERMETURE DES FORUMS DRUPAL</a></li><li><a href="indexfc2e.html?q=node/1739" title="2 commentaires">Probl√®me  avec pg_dump</a></li><li><a href="index97c1.html?q=node/1731" title="5 commentaires">Connexions simultann√©es</a></li><li><a href="index32d3.html?q=node/1737" title="1 commentaire">Optimisation de la m√©moire sous PostgreSQL</a></li><li><a href="index2483.html?q=node/1736" title="3 commentaires">[R√©solu] Upgrade Postgre -> types et op√©rateurs</a></li></ul></div><div class="item-list"><h3>Nouveaux sujets:</h3><ul><li><a href="index253f.html?q=node/1742">A LIRE : FERMETURE DES FORUMS DRUPAL</a></li><li><a href="indexfc2e.html?q=node/1739" title="2 commentaires">Probl√®me  avec pg_dump</a></li><li><a href="index32d3.html?q=node/1737" title="1 commentaire">Optimisation de la m√©moire sous PostgreSQL</a></li><li><a href="index2483.html?q=node/1736" title="3 commentaires">[R√©solu] Upgrade Postgre -> types et op√©rateurs</a></li><li><a href="index82c4.html?q=node/1734" title="2 commentaires">[RESOLU] Probleme de connection en odbc</a></li></ul></div><div class="more-link"><a href="index79b7.html?q=forum" title="Lire les derniers sujets.">en lire plus</a></div>
		    </div></div></div>
<div class="block block-archive" id="block-archive-0">
<div class="pgSideNav">    <h2>Acc√©der aux archives</h2>    
		    <div>
			
<!-- calendar -->
<div class="calendar"><table summary="Un calendrier pour acc√©der aux archives.">
 <caption><a href="index9dfb.html?q=archive/2008/09/12" title="Mois pr√©c√©dent">&laquo;</a> Octobre 2008 &nbsp;</caption>
 <tr class="header-week">
 <th abbr="Lundi">Lun</th>
 <th abbr="Mardi">Mar</th>
 <th abbr="Mercredi">Mer</th>
 <th abbr="Jeudi">Jeu</th>
 <th abbr="Vendredi">Ven</th>
 <th abbr="Samedi">Sam</th>
 <th abbr="Dimanche">Dim</th>
</tr>
 <tr class="row-week"><td class="day-blank" colspan="2">&nbsp;</td>
  <td class="day-link"><a href="indexd3e2.html?q=archive/2008/10/1">1</a></td>
  <td class="day-normal">2</td>
  <td class="day-normal">3</td>
  <td class="day-normal">4</td>
  <td class="day-normal">5</td>
 </tr>
 <tr class="row-week">
  <td class="day-normal">6</td>
  <td class="day-normal">7</td>
  <td class="day-normal">8</td>
  <td class="day-normal">9</td>
  <td class="day-normal">10</td>
  <td class="day-normal">11</td>
  <td class="day-today">12</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">13</td>
  <td class="day-future">14</td>
  <td class="day-future">15</td>
  <td class="day-future">16</td>
  <td class="day-future">17</td>
  <td class="day-future">18</td>
  <td class="day-future">19</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">20</td>
  <td class="day-future">21</td>
  <td class="day-future">22</td>
  <td class="day-future">23</td>
  <td class="day-future">24</td>
  <td class="day-future">25</td>
  <td class="day-future">26</td>
 </tr>
 <tr class="row-week">
  <td class="day-future">27</td>
  <td class="day-future">28</td>
  <td class="day-future">29</td>
  <td class="day-future">30</td>
  <td class="day-future">31</td>
  <td class="day-blank" colspan="2">&nbsp;</td>
 </tr>
</table></div>


		    </div></div></div>
<div class="block block-node" id="block-node-0">
<div class="pgSideNav">    <h2>Syndication</h2>    
		    <div>
			<div class="xml-icon"><a href="index9637.html?q=rss.xml"><img src="misc/xml.png" width="36" height="14" alt="Flux XML" title="Flux XML" /></a></div>
		    </div></div></div>
<div class="block block-poll" id="block-poll-0">
<div class="pgSideNav">    <h2>Sondage</h2>    
		    <div>
			<div class="poll"><div class="title">Quelle est la version de PostgreSQL la plus r√©pandue sur vos serveurs ?</div><div class="text">8.3</div><div class="bar"><div style="width: 10%;" class="foreground"></div></div><div class="percent">10%</div><div class="text">8.2</div><div class="bar"><div style="width: 42%;" class="foreground"></div></div><div class="percent">42%</div><div class="text">8.1</div><div class="bar"><div style="width: 40%;" class="foreground"></div></div><div class="percent">40%</div><div class="text">8.0</div><div class="bar"><div style="width: 2%;" class="foreground"></div></div><div class="percent">2%</div><div class="text">7.4</div><div class="bar"><div style="width: 6%;" class="foreground"></div></div><div class="percent">6%</div><div class="text">7.3 ou ant√©rieure</div><div class="bar"><div style="width: 0%;" class="foreground"></div></div><div class="percent">0%</div><div class="total">Nombre de votes: 48</div></div><div class="links"><a href="index8c57.html?q=node/1426#comment" title="Sauter au premier commentaire de ce message.">3 commentaires</a> | <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">anciens sondages</a></div>
		    </div></div></div>
    </td>

      <td style="vertical-align: top; width: 80%"><div class="breadcrumb"><a href="index03d2.html?q=">Accueil</a></div><h2 class="title">Points √† v√©rifier en ce qui concerne les performances de PostgreSQL 8.0</h2>
<!-- begin content -->

<!-- node: "Points √† v√©rifier en ce qui concerne les performances de PostgreSQL 8.0" -->
<!--<div class="pgFrontCenterUser">
<div class="pgFrontUser">
<div class="pgFrontUserInner">
--><div class="pgFrontUserWrap">
 <div class="pgFrontUserContent">	<h1 class="plop"><a href="index8ccf.html?q=taxonomy/term/1">Technique</a> | <a href="index18fe.html?q=node/297" class="active">Points √† v√©rifier en ce qui concerne les performances de PostgreSQL 8.0</a></h1>
		    <p>
			    Par <a href="indexc818.html?q=user/3" title="Voir le profil utilisateur.">Guillaume Lelarge</a> le 15/07/2005 - 21:16
		    </p>	
			    <p><i>Cet article est la traduction d'un billet post√© par Josh Berkus et Joe Conway sur leur site, <a href="http://powerpostgresql.com/">powerpostgresql.com</a>. D'autres documents devraient suivre...</i></p>
<p>Voici un ensemble de r√®gles de base pour votre serveur PostgreSQL<br />
8.0. Beaucoup de ces r√®gles sont bas√©es sur des anecdoctes ou des<br />
tests pratiques&nbsp;; il y a encore beaucoup de travail √† effectuer en<br />
ce qui concerne les performances des bases de donn√©es et nous essayons de<br />
les mettre en place avec OSDL. N√©anmoins, ceci devrait vous permettre de<br />
commencer. Toutes les informations ci-dessous sont utiles. Ce document,<br />
du 12 janvier 2005, sera vraisemblablement mis √† jour plus tard. Les<br />
indications sur les param√®trages ci-dessous sont pr√©f√©r√©es aux<br />
indications que j'ai p√ª donner sur General Bits.</p>
<h2>Cinq principes sur le mat√©riel de votre serveur PostgreSQL</h2>
<ol>
<li><span class="c1">Disques &gt; RAM &gt; CPU</span><br />
	Si vous devez d√©penser de l'argent dans un serveur PostgreSQL,<br />
	d√©pensez-le sur des baies de disques √† haute performance et<br />
	obtenez des processeurs moyens et une quantit√© de m√©moire ad√©quate.<br />
	PostgreSQL, comme les autres RDBMS compatibles ACID, est tr√®s<br />
	demandeur au niveau entr√©es/sorties. Il est rare que son<br />
	utilisation du CPU soit plus importante que celle de la carte SCSI<br />
	(bien que cela soit possible). Ceci s'applique aux petits serveurs<br />
	mais cela s'applique aussi aux huit voix avec NetApps&nbsp;; obtenez<br />
	un CPU √† bas prix si cela vous permet d'acheter la toute<br />
	derni√®re carte RAID et un grand nombre de disques.</li>
<li><span class="c1">Plus de t√™tes de lecture == Mieux<br /></span><br />
	Avec de nombreux disques, PostgreSQL et la plupart des syst√®mes<br />
	d'exploitation parall√®liseront les demandes de lecture et d'√©criture<br />
	sur la base de donn√©es. Ceci fera une √©norme diff√©rence sur les<br />
	syst√®mes de traitement des transactions et sera une am√©lioration<br />
	significative pour toute application o√π la base de donn√©es ne tient<br />
	pas enti√®rement en m√©moire. √âtant donn√© les tailles minimales des<br />
	disques de nos jours (72&nbsp;Go), vous pourriez √™tre tent√© de<br />
	n'utiliser qu'un seul disque ou une seule paire en RAID 1&nbsp;;<br />
	n√©anmoins, vous trouverez que l'utilisation de 4, 6, voire m√™me 14<br />
	disques am√®neront un surplus de puissance. √âvidemment, le SCSI est<br />
	toujours significativement meilleur que l'IDE, m√™me avec SATA.</li>
<li><span class="c1">S√©parez les journaux des transactions de la base de<br />
	donn√©es<br /></span> En supposant que vous avez d√©j√† plac√© de<br />
	l'argent sur une baie de dimension raisonnable, il existe quelques<br />
	autres options intelligentes plut√¥t que de tout placer dans un RAID<br />
	simple. En particulier, placer les journaux de la base de donn√©es<br />
	(pg_xlog) sur sa propre ressource disque d√©di√©e (une baie ou un<br />
	disque) peut fournir un gain jusqu'√† 12&nbsp;% sur des bases de<br />
	donn√©es comprenant une grosse activit√© en √©criture. Ceci est tout<br />
	particuli√®rement vitale sur les petits syst√®mes avec des disques<br />
	SCSI ou IDE lents. Ceci fonctionne aussi dans le cas d'un serveur<br />
	comprenant deux disques&nbsp;; vous pouvez placer les journaux dans<br />
	le disque du syst√®me d'exploitation et obtenir ainsi un gain simple.</li>
<li><span class="c1">RAID 1+0/0+1 &gt; RAID 5</span><br />
	Le RAID 5 avec trois disques est devenu un standard malheureux parmi<br />
	les serveurs √©conomiques des gros vendeurs. Ceci est la configuration<br />
	de baie la plus lente qu'il soit pour PostgreSQL&nbsp;; vous pouvez<br />
	esp√©rer un petit 50&nbsp;% par rapport √† ce que vous pourriez obtenir<br />
	avec un simple disque SCSI. √Ä la place, concentrez-vous sur du RAID<br />
	1 ou 1+0 ou 0+1 avec un ensemble de 2, 4 ou 6 disques. Avec plus de six<br />
	disques, RAID 5 commence √† se comporter de fa√ßon acceptable au niveau<br />
	des performances et la comparaison se fera plus au niveau de la<br />
	qualit√© de votre contr√¥leur individuel. Peut-√™tre plus important, une<br />
	carte RAID bon march√© peut √™tre un risque&nbsp;; il est quelque<br />
	fois pr√©f√©rable d'utiliser du RAID logiciel plut√¥t que la carte Adaptec<br />
	int√©gr√©e fournie avec votre serveur.</li>
<li><span class="c1">Les applications doivent bien se comporter<br />
	mutuellement</span><br />
	L'autre grosse erreur que j'ai vu dans bon nombre de soci√©t√© est de<br />
	placer PostgreSQL avec plusieurs autres applications sur un seul<br />
	serveur, o√π tout le monde finit par se battre pour les m√™mes<br />
	ressources. Encore pire, placer PostgreSQL et d'autres RDBMS sur la<br />
	m√™me machine&nbsp;; les syst√®mes de bases de donn√©es vont se battre<br />
	pour obtenir la bande passante du disque et le cache disque du<br />
	syst√®me d'exploitation, et ils en p√¢tiront tous. Les serveurs de<br />
	documents et les programmes cr√©ant des traces de s√©curit√© sont<br />
	pratiquement aussi mauvais. PostgreSQL peut g√©rer une machine avec<br />
	des applications qui ont des besoins principalement au niveau CPU<br />
	et RAM, comme Apache, en supposant qu'il y ait suffisamment de RAM.</li>
</ol>
<h2>Douze param√®trages que vous voudrez ajuster dans votre fichier<br />
PostgreSQL.Conf</h2>
<p>Il existe vraiment un nombre effrayant de nouvelles options dans le<br />
fichier PostgreSQL.conf. M√™me les options famili√®res des cinq derni√®res<br />
versions ont vu leurs noms ou le format de leur param√®tres chang√©s.<br />
Le but est de vous donner plus de contr√¥le (vous, les administrateurs des<br />
bases de donn√©es). Mais cela vous peut vous demander du temps.</p>
<p>Ce qui suit sont les param√®trages que la plupart des administrateurs<br />
de bases de donn√©es voudront modifier, avec une attention port√©e plus<br />
fortement vers la performance. Il existe quelques param√®tres<br />
sp√©cialis√©s que la plupart des utilisateurs ne toucheront pas mais que ceux<br />
qui les utilisent trouveront indispensables. Pour ceux-l√†, il leur faudra<br />
attendre le livre.</p>
<p><span class="c2">Rappelez-vous&nbsp;: les param√®tres de PostgreSQL.conf<br />
ne doivent pas √™tre comment√©s pour √™tre pris en compte, et les mettre de<br />
nouveau en commentaire ne restaure pas forc√©ment leur valeur par<br />
d√©faut&nbsp;!</span></p>
<h3>Connexions</h3>
<p><span class="c1">listen_addresses&nbsp;:</span> Remplace √† la fois<br />
les param√®tres tcp_ip et virtual_hosts de la version 7.4. Vaut, par d√©faut,<br />
localhost dans la plupart des installations, autorisant uniquement les<br />
connexions sur la console. La plupart des administrateurs de bases de<br />
donn√©es voudront le configurer √† ¬´&nbsp;*&nbsp;¬ª, signifiant toutes les interfaces<br />
disponibles, une fois que les bons droits ont √©t√© configur√©s dans le<br />
fichier pg_hba.conf, pour que PostgreSQL soit accessible du r√©seau.<br />
Comme am√©lioration par rapport aux versions pr√©c√©dentes, la valeur<br />
¬´&nbsp;localhost&nbsp;¬ª par d√©faut permet les connexions sur l'interface<br />
¬´&nbsp;loopback&nbsp;¬ª, 127.0.0.1, activant les nombreux outils bas√©s sur<br />
les navigateurs.</p>
<p><span class="c1">max_connections&nbsp;:</span> Exactement comme dans<br />
les versions pr√©c√©dentes, cette variable a besoin d'√™tre configur√©e pour<br />
atteindre le nombre r√©el de connexions dont vous pensez avoir besoin.<br />
Une valeur haute va requ√©rir plus de m√©moire partag√©e (shared_buffers).<br />
Comme la surcharge pour chaque connexion, √† la fois du c√¥t√© de PostgreSQL<br />
et de celui du syst√®me h√¥te, il est important d'utiliser une queue de<br />
connexion si vous avez besoin d'un grand nombre d'utilisateurs. Par<br />
exemple, 150 connexions actives sur un seul processeur 32 bit de qualit√©<br />
moyenne sur un serveur Linux consommera des ressources significatives.<br />
600 est la limite sur ce mat√©riel. Bien s√ªr, un mat√©riel plus costaud<br />
permettra un plus grand nombre de connexions.</p>
<h3>M√©moire</h3>
<p><span class="c1">shared_buffers&nbsp;:</span> Rappel&nbsp;:<br />
cette variable n'est PAS la m√©moire totale qu'utilise PostgreSQL.<br />
C'est le bloc de m√©moire d√©di√© que PostgreSQL utilise pour ses<br />
op√©rations actives et devrait correspondre √† une quantit√© mineure de<br />
la m√©moire totale sur votre machine car PostgreSQL utilise aussi le cache<br />
disque du syst√®me d'exploitation. Malheureusement, le nombre exact de<br />
tampons partag√©s requis est un calcul complexe entre la RAM totale, la<br />
taille de la base de donn√©es, le nombre de connexions et la complexit√©<br />
des requ√™tes. Donc, il est pr√©f√©rable d'utiliser quelques r√®gles de base<br />
dans l'allocation et de surveiller le serveur (particuli√®rement via les<br />
vues pg_statio) pour d√©terminer les ajustements n√©cessaires.<br />
Sur des serveurs d√©di√©s, les valeurs possibles semblent se situer entre<br />
8&nbsp;Mo et 400&nbsp;Mo (entre 1&nbsp;000 et 50&nbsp;000 pages de<br />
8&nbsp;Ko). Les facteurs qui √©l√®vent les tampons partag√©s d√©sir√©s sont<br />
des portions actives plus importantes, des grosses requ√™tes complexes,<br />
de nombreuses requ√™tes simultan√©es, des proc√©dures ou des transactions<br />
s'ex√©cutant sur une grosse p√©riode, plus de RAM disponible et des<br />
processeurs plus nombreux ou plus rapides. Et, bien s√ªr, d'autres<br />
applications sur la machine. Contrairement √† certaines attentes, allouer<br />
bien trop de shared_buffers peut r√©ellement baisser les performances, le<br />
temps normalement requis pour le parcours. Voici quelques exemples bas√©s<br />
sur des anecdotes et sur des tests TPC sur machines Linux&nbsp;:</p>
<ul>
<li>Portable, processeur Celeron, 384&nbsp;Mo de RAM, base de donn√©es<br />
	de 25&nbsp;Mo&nbsp;: 12&nbsp;Mo/1500</li>
<li>Serveur Athlon, 1&nbsp;Go de RAM, base de donn√©es d√©cisionnelle<br />
	10&nbsp;Go&nbsp;: 120&nbsp;Mo/15000</li>
<li>Serveur Quadri PIII, 4&nbsp;Go de RAM, 40&nbsp;Go, base de donn√©es<br />
	de traitements de grosses transactions (150 connexions)&nbsp;:<br />
	240&nbsp;Mo/30000</li>
<li>Serveur Quadri Xeon, 8&nbsp;Go de RAM, 200&nbsp;Go, base de donn√©es<br />
	de traitement de grosses transactions (300 connexions)&nbsp;:<br />
	400MB/50000</li>
</ul>
Merci de noter qu'augmenter shared_buffers, et quelques autres<br />
param√®tres m√©moire, vous demandera de modifier les param√®tres m√©moire<br />
System V du syst√®me d'exploitation. Voir la documentation de PostgreSQL<br />
pour des instructions sur ceci.</p>
<p><span class="c1">work_mem&nbsp;:</span> Auparavant appel√©<br />
sort_mem, mais renomm√© depuis car il couvre aussi les tris, les<br />
agr√©gats et quelques autres op√©rations. C'est une m√©moire non<br />
partag√©e qui est allou√©e par op√©ration (une √† plusieurs fois par<br />
requ√™te)&nbsp;; ce param√®tre est situ√© ici pour placer une limite<br />
sur la m√©moire RAM que chaque op√©ration peut allouer avant d'√™tre forc√©<br />
√† √©crire sur disque. Il devrait √™tre configur√© suivant un calcul bas√©<br />
en divisant la RAM disponible (apr√®s les applications et shared_buffers)<br />
par le nombre de requ√™tes maximum attendu, multipli√© par le nombre<br />
moyen d'op√©rations par requ√™te utilisant de la m√©moire.<br />
Une certaine attention doit aussi √™tre port√©e sur la valeur de<br />
work_mem n√©cessaire √† chaque requ√™te&nbsp;; traiter de grands ensembles<br />
de donn√©es en requiert plus. Les applications web utilisant des bases<br />
de donn√©es configurent g√©n√©ralement une valeur assez basse car le nombre<br />
de connexions est assez grand et les requ√™tes sont simples&nbsp;;<br />
de 512&nbsp;Ko √† 2048&nbsp;Ko suffit g√©n√©ralement. Au contraire, les<br />
applications de support de d√©cision avec leur requ√™tes de 160 lignes et<br />
les agr√©gats de plus de 10&nbsp;millions de lignes demandent souvent<br />
beaucoup plus, pratiquement 500&nbsp;Mo sur un serveur disposant de<br />
beaucoup de m√©moire. Pour des bases de donn√©es √† utilisation mixe, ce<br />
param√®tre peut √™tre configur√© par connexion, au moment du lancement<br />
de la requ√™te, pour donner plus de RAM √† certaines requ√™tes sp√©cifiques.
</p>
<p><span class="c1">maintenance_work_mem&nbsp;:</span> Appel√©e auparavant<br />
vacuum_mem, ceci est la quantit√© de RAM que PostgreSQL utilise pour<br />
VACUUM, ANALYZE, CREATE INDEX et l'ajout de cl√©s √©trang√®res. Vous devez<br />
l'augmenter suivant la taille des tables de votre base de donn√©es et la<br />
quantit√© de m√©moire que vous pouvez donner pour rendre les op√©rations<br />
aussi rapides que possibles. Un param√®trage de 50&nbsp;% √† 75&nbsp;% de<br />
la taille (sur disque) de votre plus grosse table ou index est une bonne<br />
r√®gle, ou entre 32 et 256&nbsp;Mo lorsqu'il n'est pas possible de le<br />
d√©terminer.</p>
<h3>Disque et WAL</h3>
<p><span class="c1">checkpoint_segments&nbsp;:</span> D√©finit la taille<br />
cache sur disque du journal des transactions pour les op√©rations<br />
d'√©criture. Vous pouvez ignorer ceci dans les applications web utilisant<br />
des bases de donn√©es car elles sont principalement utilis√©es pour de la<br />
lecture. Mais, dans le cas des bases de donn√©es utilisant des transactions<br />
ou cr√©ant des rapports impliquant de gros volumes de donn√©es, l'augmenter<br />
est critique pour les performances. Suivant le volume des donn√©es,<br />
augmentez-le de 12 √† 256 segments, en commen√ßant avec des valeurs basses<br />
et en l'augmentant lorsque vous apercevez des messages d'avertissements<br />
dans les journaux de trace. L'espace requis sur disque est √©gal √†<br />
(checkpoint_segments * 2 + 1) * 16MB, donc assurez-vous que vous disposez<br />
d'assez de place disque (32 signifiant plus d'1&nbsp;Go).</p>
<p><span class="c1">max_fsm_pages&nbsp;:</span> Taille du registre<br />
tra√ßant partiellement les pages de donn√©es vides pour les peupler plus<br />
tard avec de nouvelles donn√©es&nbsp;; si elle est bien configur√©e, elle<br />
rend le VACUUM plus rapide et supprime le besoin de VACUUM FULL et de<br />
REINDEX. Devrait √™tre l√©g√®rement sup√©rieure au nombre total de pages de<br />
donn√©es qui sera touch√© par les mises √† jour et suppressions entre<br />
VACUUM. Les deux fa√ßons de d√©terminer ce nombre sont de lancer VACUUM<br />
VERBOSE ANALYZE ou, dans le cas de l'utilisation d'autovacuum (voir<br />
ci-dessous), de configurer ceci suivant la valeur du param√®tre -V en<br />
tant que pourcentage des pages de donn√©es totales utilis√©es par votre<br />
base de donn√©es. fsm_pages requiert tr√®s peu de m√©moire, donc il vaut<br />
mieux √™tre g√©n√©reux ici.</p>
<p><span class="c1">vacuum_cost_delay&nbsp;:</span> Si vous avez des<br />
tables importantes et un nombre significatif d'√©critures concurrentes,<br />
vous pourriez vouloir utiliser une nouvelle fonctionnalit√© qui diminue<br />
l'activit√© I/O des VACUUM au prix de les rendre plus long. Comme il<br />
s'agit d'une toute nouvelle fonctionnalit√©, c'est une valeur complexe<br />
comprenant cinq param√®tres ind√©pendants pour lesquels nous n'avons que<br />
quelques tests de performance. Augmenter vacuum_cost_delay √† une valeur<br />
non nulle active cette fonctionnalit√©&nbsp;; utilisez un d√©lai<br />
raisonnable, quelque part entre 50 et 200&nbsp;ms. Pour une configuration<br />
plus fine, augmenter vacuum_cost_page_hit et d√©cro√Ætre<br />
vacuum_cost_page_limit amoindrira l'impact des op√©rations VACUUM et les rendra<br />
plus lentes&nbsp;; dans les tests de Jan Wieck pour des traitements de<br />
transaction, un d√©lai de 200, un page_hit de 6 et une limite de 100 fait<br />
d√©cro√Ætre l'impact du VACUUM de plus de 80&nbsp;% en triplant le temps<br />
d'ex√©cution.</p>
<h3>Planificateur de requ√™tes</h3>
<p>Ces param√®tres permettent au planificateur de requ√™tes de disposer<br />
d'estimations plus justes et, du coup, de choisir le meilleur plan possible.<br />
Il existe deux param√®tres globaux dont il vaut mieux s'occuper&nbsp;:</p>
<p><span class="c1">effective_cache_size&nbsp;:</span> Indique au<br />
planificateur de requ√™tes l'objet en base de donn√©es le plus gros qu'il<br />
peut s'attendre √† avoir √† placer en cache. Devrait g√©n√©ralement √™tre<br />
configur√© au 2/3 de la RAM totale, dans le cas d'un serveur d√©di√©. Sur<br />
un serveur √† utilisation mixe, vous aurez √† estimer le nombre total de<br />
m√©moire RAM et de cache disque du syst√®me d'exploitation utilis√© par<br />
les applications et le soustraire.</p>
<p><span class="c1">random_page_cost&nbsp;:</span> Une variable qui<br />
estime le co√ªt moyen des recherches pour des pages de donn√©es r√©cup√©r√©es<br />
via l'index. Sur des machines tr√®s rapides, avec des baies de disques<br />
tr√®s rapides, elle devrait √™tre diminu√©e, √† 3,0, 2,5 voire m√™me 2,0.<br />
N√©anmoins, si la portion active de votre base de donn√©es est bien plus<br />
grosse que votre m√©moire, vous augmenterez le facteur √† la valeur<br />
par d√©faut de 4. Autrement, vous basez vos ajustements sur la<br />
performance des requ√™tes. Si le planificateur semble favoriser sans<br />
raison les parcours s√©quentiels par rapport aux parcours d'index,<br />
baissez-le. Assurez-vous de tester une grande vari√©t√© de requ√™tes. Ne<br />
passez pas en-dessous de 2,0&nbsp;; si cela semble n√©cessaire, vous<br />
avez besoin d'ajuster des variables comprises dans des domaines,<br />
comme les statistiques de planification.</p>
<h3>Traces</h3>
<p><span class="c1">log_destination&nbsp;:</span> Ceci remplace le<br />
param√®trage non intuitif de syslog dans les versions pr√©c√©dentes. Vos<br />
choix sont d'utiliser le journal du syst√®me d'exploitation (syslog ou<br />
eventlog) ou d'utiliser un journal de trace s√©par√© pour PostgreSQL<br />
(stderr). Le premier choix est meilleur en ce qui concerne la<br />
surveillance du syst√®me&nbsp;; le deuxi√®me est pr√©f√©rable pour corriger<br />
les probl√®mes de la base de donn√©es et pour am√©liorer sa configuration.</p>
<p><span class="c1">redirect_stderr&nbsp;:</span> Si vous d√©cidez<br />
d'utiliser un journal de traces s√©par√© pour PostgreSQL, ce param√®trage<br />
vous permet de tracer dans un fichier en utilisant un outil de<br />
PostgreSQL au lieu de la redirection de la ligne de commande, vous<br />
permettant une rotation automatis√©e des traces. Configurez-le √† True,<br />
puis configurez log_directory en lui indiquant o√π placer les traces.<br />
Les configurations par d√©faut pour log_filename, log_rotation_size et<br />
log_rotation_age conviennent √† la plupart des gens.</p>
<h3>Autovacuum et vous</h3>
<p>Lors de votre progression vers la production en 8.0, vous devrez<br />
configurer un plan de maintenance qui inclut les VACUUM et ANALYZE. Si<br />
votre base de donn√©es doit g√©rer un flot important d'√©criture de donn√©es<br />
mais ne requiert pas de chargement ou de suppression massifs de donn√©es<br />
ou de red√©marrages fr√©quents, ceci pourrait impliquer la configuration<br />
de pg_autovacuum. C'est bien mieux qu'un VACUUM r√©gulier parce<br />
que&nbsp;:</p>
<ul>
<li>Les tables sont VACUUM√©es suivant leur activit√©, ceci permettant<br />
	d'√©viter de lancer des VACUUM sur des tables en lecture seule.</li>
<li>La fr√©quence des VACUUM augmente automatiquement avec<br />
	l'acroissement de l'activit√© de la base de donn√©es.</li>
<li>Il est plus simple de calculer les besoins pour le "free space<br />
	map" et √©viter ainsi un engorgement de la base de donn√©es.</li>
</ul>
<p>Configurer autovacuum requiert une construction facile du module<br />
compris dans le r√©pertoire contrib/pg_autovacuum de vos sources<br />
PostgreSQL (les utilisateurs Windows devraient trouver autovaccuum inclus<br />
dans le paquetage PGInstaller). Vous activerez les param√®trages de<br />
configuration des statistiques d√©taill√©es dans le fichier README. Ensuite,<br />
vous lancez autovacuum une fois que PostgreSQL a d√©marr√© et en tant que<br />
processus s√©par√©&nbsp;; il s'arr√™tera automatiquement lors de l'arr√™t<br />
de PostgreSQL.</p>
<p>La configuration par d√©faut d'autovacuum est tr√®s basse et tout<br />
√† fait convenable pour une tr√®s petite base de donn√©es. J'utilise<br />
g√©n√©ralement quelque chose de plus agressif comme&nbsp;:<br />
<code>-D -v 400 -V 0.4 -a 100 -A 0.3</code><br />
Ceci lance VACUUM sur les tables apr√®s que 400 lignes + 40&nbsp;% de la<br />
table ont √©t√© ins√©r√©es, mises √† jour ou supprim√©es. La configuration<br />
ci-dessus vous laisse aussi configurer max_fsm_pages √† 50&nbsp;% des<br />
pages de donn√©es dans la base avec la certitude que ce nombre ne sera<br />
pas d√©pass√©, causant un d√©bordement de la base de donn√©es. Nous testons<br />
actuellement diff√©rents param√®trages √† OSDL et il y aura quelques cas<br />
difficiles plus bas.</p>
<p>Notez que vous pouvez aussi utiliser autovacuum pour configurer les<br />
options de d√©lai du VACUUM, au lieu de le faire dans PostgreSQL.conf. Le<br />
d√©lai du vacuum peut √™tre d'une importance vitale pour les syst√®mes avec<br />
de tr√®s grosses tables ou index&nbsp;; sinon, un appel autovacuum (non<br />
planifi√©) peut arr√™ter une op√©ration importante.</p>
<p>Malheureusement, il existe un ensemble de limitations s√©rieuses √†<br />
l'autovacuum de la 8.0, limitations qui seront √©limin√©es dans les<br />
versions futures&nbsp;:</p>
<ul>
<li>Pas de m√©moire √† long terme&nbsp;: autovacuum oublie toutes ces<br />
	traces d'activit√© lors du red√©marrage de la base de donn√©es. Donc, si<br />
	vous effectuez des red√©marrages r√©guliers, vous devrez faire un VACUUM<br />
	ANALYZE complet des bases de donn√©es tout juste apr√®s.</li>
<li>Ne fait pas attention √† l'activit√© du serveur&nbsp;: il existait<br />
	des plans pour v√©rifier la charge du syst√®me avant le VACUUM, mais ce<br />
	n'est pas une fonctionnalit√© actuelle. Donc, si vous avez des pics de<br />
	charge extr√™me, autovacuum pourrait ne pas √™tre le bon choix pour<br />
	vous.</li>
</ul>
<div id="footerText">
Copyright Josh Berkus et Joe Conway, <a href="License/index.html">OPL Licensed</a><br/><br />
Traduction fran√ßaise, Guillaume Lelarge.
</div>

		     </div></div>
<!--</div>
</div>
</div>
</div> -->
<a id="comment"></a>
<form method="post" action="http://drupal.postgresql.fr/?q=comment"><div>
<div class="pgSideNav">    <h2>Options d'affichage des commentaires</h2>    
		    <div>
			<div class="form-item">
 <select name="mode"> <option value="1">A plat - repli√©</option>
 <option value="2">A plat - d√©pli√©</option>
 <option value="3">Par discussions - repli√©</option>
 <option value="4" selected="selected">Par discussions - d√©pli√©</option>
</select>
<select name="order"> <option value="1">Date - r√©cents en premier</option>
 <option value="2" selected="selected">Date - anciens en premier</option>
</select>
<select name="comments_per_page"> <option value="10">10 commentaires par page</option> <option value="30">30 commentaires par page</option> <option value="50" selected="selected">50 commentaires par page</option> <option value="70">70 commentaires par page</option> <option value="90">90 commentaires par page</option></select>
<input type="hidden" name="threshold" value="0" />
 <input type="submit" class="form-submit" name="op" value="Sauvegarder les param√®tres"  />

 <div class="description">S√©lectionnez la m√©thode d'affichage des commentaires que vous pr√©f√©rez, puis cliquez sur "Sauvegarder les param√®tres" pour activer vos changements.</div>
</div>

		    </div></div><input type="hidden" name="edit[nid]" value="297" />
</div></form><form method="post" action="http://drupal.postgresql.fr/?q=comment"><div>
<input type="hidden" name="edit[nid]" value="297" />
<a id="comment-269"></a>
<div class="pgContentWrap"><h1 id="txtFrontFeatureHeading">Guillaume a encore frapp√© :-)</h1>
		<p>
		    <b><a href="indexec55.html?q=user/2" title="Voir le profil utilisateur.">Jean-Paul Argudo</a></b>/ = 16 Juillet, 2005 - 18:25
		</p>
		<p>
		    <p>Guillaume a encore frapp√© en traduisant un des articles les plus int√©ressants du moment... Admirez la pr√©cision de la traduction...</p>
<p>
Si vous aimez PostgreSQL et que vous voulez contribuer au projet, il y a un moyen simple et accessible au plus grand nombre pour le faire&nbsp;: tout comme Guillaume Lelarge, vous pouvez traduire les fichiers relatifs au projet, la doc, des articles, etc.. Pour cela, allez faire un petit tour sur le site de Guillaume, √ßa vaut le d√©tour&nbsp;:<br />
<a href="http://traduc.postgresqlfr.org/" target="_blank">http://traduc.postgresqlfr.org</a></p>
<p>Bravo et merci Guillaume (et tous ses amis). Encore une fois&nbsp;: <b>N'h√©sitez pas √† le contacter et √† l'aider&nbsp;!</b></p>
<p>
--<br />
Jean-Paul ARGUDO<br />
www.PostgreSQLFr.org
</p>
<br /><!--hr /--><div class="contentsLink">[ Vous devez <a href="index7992.html?q=user/login">vous connecter</a> pour poster des commentaires ]</div>
		</p></div><a id="comment-288"></a>
<div class="pgContentWrap"><h1 id="txtFrontFeatureHeading">Doc / slide en anglais sur l'optimisation</h1>
		<p>
		    <b><a href="index53fc.html?q=user/312" title="Voir le profil utilisateur.">thomas silvi</a></b>/ = 23 Juillet, 2005 - 13:38
		</p>
		<p>
		    <p>Les slides sont disponibles a cette adresse :<br />
http://www.gtsm.com/oscon2003/toc.html</p>
<p>Cela explique pas mal de choses mais il faut prendre le temps<br />
de le lire.</p>
<br /><!--hr /--><div class="contentsLink">[ Vous devez <a href="index7992.html?q=user/login">vous connecter</a> pour poster des commentaires ]</div>
		</p></div></div></form>
<!-- end content -->
              </td>

    </tr>
    <tr><td colspan="2">

		<div class="pgTopNav">
		   <div class="pgTopNavLeft"> 
		     <img src="layout/images/nav_lft.png" width="7" height="23" alt="" />
		   </div>
		   <div class="pgTopNavRight">
		    <img src="layout/images/nav_rgt.png" width="7" height="23" alt="" />
		  </div>
		  <!--<ul class="pgTopNavList">-->
		  <ul class="pgTopNavList">
		   <li><a href="index03d2.html?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="indexf6e5.html?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="index71c4.html?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>

		   <li> <a href="indexf6fe.html?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="index79b7.html?q=forum">forums</a> </li>
		   <li> <a href="index729f.html?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="index4404.html?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>

		  </ul>

<!--
		   <li><a href="?q=" title="Retourner √† la page principale.">accueil</a> </li>
		   <li> <a href="?q=archive" title="Lire le contenu plus ancien dans notre archive.">archives</a> </li>
		   <li> <a href="?q=blog" title="Lire les blogues les plus r√©cents.">blogues</a> </li>
		   <li> <a href="?q=book" title="Lire et contribuer aux livres collaboratifs.">livres</a> </li>
		   <li> <a href="?q=forum">forums</a> </li>
		   <li> <a href="?q=poll" title="Voir la liste des sondages de ce site.">sondages</a> </li>
		   <li> <a href="?q=search" title="Chercher pour du contenu plus vieux.">recherche</a></li><li><a href="http://docs.postgresqlfr.org/" target="_blank">documentation </a></li>
-->
		  </ul>
	        </div>
    </td></tr>
   </table>
   <p style="text-align: center;">&copy;&nbsp;PostgreSQLFr, tous droits r√©serv√©s.<br>
Site d√©clar√© √† la CNIL sous le num√©ro 1074678, conform√©ment √† la Loi en vigueur.
</p>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3921927-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<p></p>
   
</body>

<!-- Mirrored from drupal.postgresql.fr/?q=node/297 by HTTrack Website Copier/3.x [XR&CO'2006], Sun, 12 Oct 2008 15:57:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>